<% 
require 'csv'
@first_activity_row = 6
columns = [
	'Objective',
	'Task',
	'Activity Completed',
	'Total Hours',
	'Minutes',
	'Total Mins',
	'Activity Comment',
]
-%>
<%= CSV.generate_line( ['Dates FIXME', '2010-11-23', '2010-12-14'] ) %>
<%= %>
<%= CSV.generate_line( columns ) %>
<% 
@activity_rows = 0
@project.objectives.each { |objective| 
	objective.tasks.each { |task|
@activity_rows += task.activities.size() +2
-%>
<%= %>
<%= CSV.generate_line( [objective.name, task.name, nil, task.hours, nil, task.minutes] ).html_safe -%>
	<% task.activities.each { |activity| -%>
<%= CSV.generate_line([nil, nil, activity.local_stop_time, nil, activity.minutes, nil, activity.description]).html_safe -%>
	<% 
		}
	} 
}
-%>

<%= %>
<%# CSV.generate_line( [nil, nil, nil, (total_minutes / 60.0), 'total hours', total_minutes, 'total minutes'] ) -%>
<%= CSV.generate_line( ['Total', nil, nil, csv_sum_rows('D', @first_activity_row, @activity_rows), nil, csv_sum_rows('E', @first_activity_row, @activity_rows)] ) -%>
<%= %>
<%= CSV.generate_line( ['Document created at', Time.now.to_s] ) -%>
